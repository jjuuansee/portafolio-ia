<!DOCTYPE html>
<!-- saved from url=(0061)https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/ -->
<html lang="es" class="js-focus-visible js" data-js-focus-visible=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
      
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="https://juanfkurucz.com/ucu-id/assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Práctica 5: Missing Data Detective - Ingeniería de Datos - Universidad Católica del Uruguay</title>
      
    
    
      <link rel="stylesheet" href="https://juanfkurucz.com/ucu-id/assets/stylesheets/main.e53b48f4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
        <link rel="stylesheet" href="./Práctica 5_ Missing Data Detective - Ingeniería de Datos - Universidad Católica del_files/cs">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link href="https://juanfkurucz.com/ucu-id/assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="https://juanfkurucz.com/ucu-id/assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#practica-5-missing-data-detective-fill-in-the-blanks" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="https://juanfkurucz.com/ucu-id/" title="Ingeniería de Datos - Universidad Católica del Uruguay" class="md-header__button md-logo" aria-label="Ingeniería de Datos - Universidad Católica del Uruguay" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title md-header__title--active" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ingeniería de Datos - Universidad Católica del Uruguay
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Práctica 5: Missing Data Detective
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required="">
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0">
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">Teclee para comenzar búsqueda</div>
          <ol class="md-search-result__list" role="presentation" hidden=""></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" style="top: 48px;">
                <div class="md-sidebar__scrollwrap" style="height: 468px;">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://juanfkurucz.com/ucu-id/" title="Ingeniería de Datos - Universidad Católica del Uruguay" class="md-nav__button md-logo" aria-label="Ingeniería de Datos - Universidad Católica del Uruguay" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    Ingeniería de Datos - Universidad Católica del Uruguay
  </label>
  
  <ul class="md-nav__list">
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://juanfkurucz.com/ucu-id/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://juanfkurucz.com/ucu-id/ut1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UT1
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://juanfkurucz.com/ucu-id/ut2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UT2
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://juanfkurucz.com/ucu-id/recursos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recursos
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" style="top: 48px;">
                <div class="md-sidebar__scrollwrap" style="height: 468px;">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc">
      
        <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#objetivos-basicos" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      🎯 Objetivos Básicos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#lo-que-necesitas-saber-antes-de-empezar" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      📋 Lo que necesitas saber ANTES de empezar
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📋 Lo que necesitas saber ANTES de empezar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#parte-1-setup-y-carga-de-datos" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      🔍 Parte 1: Setup y Carga de Datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-2-cargar-y-crear-missing-data-sintetico" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      🏠 Paso 2: Cargar y Crear Missing Data Sintético
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-3-analisis-inicial-del-dataset" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      📊 Paso 3: Análisis Inicial del Dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-4-deteccion-de-patrones-de-missing-data" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      🔍 Paso 4: Detección de Patrones de Missing Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-5-clasificar-tipos-de-missing-data" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      🧠 Paso 5: Clasificar Tipos de Missing Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-6-deteccion-de-outliers" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      🚨 Paso 6: Detección de Outliers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-7-deteccion-de-outliers-con-z-score" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      🔍 Paso 7: Detección de Outliers con Z-Score
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-8-visualizacion-de-outliers" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      📊 Paso 8: Visualización de Outliers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-9-estrategias-de-imputacion" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      🔧 Paso 9: Estrategias de Imputación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-10-imputacion-inteligente-por-tipo-de-missing" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      🧠 Paso 10: Imputación Inteligente por Tipo de Missing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-11-anti-leakage-basico" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      🚫 Paso 11: Anti-Leakage Básico
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-12-analisis-de-impacto-de-la-imputacion" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      📊 Paso 12: Análisis de Impacto de la Imputación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-13-pipeline-de-limpieza-reproducible" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      🔧 Paso 13: Pipeline de Limpieza Reproducible
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#parte-b-analisis-critico" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      🎯 Parte B: Análisis Crítico
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🎯 Parte B: Análisis Crítico">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#preguntas-de-reflexion" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      📝 Preguntas de Reflexión
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#sugerencias-para-explorar-mas" class="md-nav__link md-nav__link--passed">
    <span class="md-ellipsis">
      🚀 Sugerencias para Explorar Más
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🚀 Sugerencias para Explorar Más">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#otros-datasets-interesantes" class="md-nav__link md-nav__link--passed md-nav__link--active">
    <span class="md-ellipsis">
      📊 Otros Datasets Interesantes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#algoritmos-avanzados-de-imputacion" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Algoritmos Avanzados de Imputación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#tecnicas-de-deteccion-de-outliers-avanzadas" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 Técnicas de Detección de Outliers Avanzadas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="practica-5-missing-data-detective-fill-in-the-blanks">🔍 Práctica 5: Missing Data Detective - Fill in the Blanks<a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#practica-5-missing-data-detective-fill-in-the-blanks" title="Permanent link">¶</a></h1>
<p><strong>UT2: Calidad &amp; Ética</strong> | <strong>Práctica Guiada</strong></p>
<h2 id="objetivos-basicos">🎯 Objetivos Básicos<a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#objetivos-basicos" title="Permanent link">¶</a></h2>
<ul>
<li>Aprender a detectar y analizar datos faltantes (MCAR, MAR, MNAR)</li>
<li>Identificar outliers usando métodos estadísticos</li>
<li>Implementar estrategias de imputación apropiadas</li>
<li>Crear pipelines de limpieza reproducibles</li>
<li>Considerar aspectos éticos en el tratamiento de datos</li>
</ul>
<h2 id="lo-que-necesitas-saber-antes-de-empezar">📋 Lo que necesitas saber ANTES de empezar<a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#lo-que-necesitas-saber-antes-de-empezar" title="Permanent link">¶</a></h2>
<ul>
<li>Conceptos básicos de pandas y visualización</li>
<li>Idea general de qué son los datos faltantes</li>
<li>Curiosidad por entender patrones en la calidad de datos</li>
</ul>
<hr>
<h3 id="parte-1-setup-y-carga-de-datos">🔍 Parte 1: Setup y Carga de Datos<a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#parte-1-setup-y-carga-de-datos" title="Permanent link">¶</a></h3>
<p><strong>📋 CONTEXTO DE NEGOCIO (CRISP-DM: Business Understanding)</strong></p>
<p>🔗 <strong>Referencias oficiales:</strong></p>
<ul>
<li><a href="https://www.kaggle.com/learn/data-cleaning/lesson/1">Kaggle Data Cleaning - Handling Missing Values</a></li>
<li><a href="https://pandas.pydata.org/docs/">Pandas Documentation</a></li>
<li><a href="https://matplotlib.org/stable/contents.html">Matplotlib Documentation</a></li>
<li><a href="https://seaborn.pydata.org/">Seaborn Documentation</a></li>
<li><a href="https://scikit-learn.org/stable/">Scikit-learn Documentation</a></li>
</ul>
<p><strong>🏠 Caso de negocio:</strong></p>
<ul>
<li><strong>Problema</strong>: El dataset Ames Housing tiene datos faltantes y outliers que afectan las predicciones de precios</li>
<li><strong>Objetivo</strong>: Detectar patrones de missing data y outliers para limpiar el dataset</li>
<li><strong>Variables</strong>: SalePrice, LotArea, YearBuilt, GarageArea, Neighborhood, HouseStyle, etc.</li>
<li><strong>Valor para el negocio</strong>: Datos más limpios = predicciones de precios más confiables</li>
</ul>
<div class="highlight"><pre id="__code_0"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_0 &gt; code"></button><code tabindex="0"><span class="c1"># === SETUP DEL ENTORNO ===</span>

<span class="c1"># 1. Importar librerías necesarias</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pandas.api.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_numeric_dtype</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">'ignore'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"✅ Todas las librerías importadas correctamente"</span><span class="p">)</span>

<span class="c1"># 3. Configurar visualizaciones</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">'_______'</span><span class="p">)</span>  <span class="c1"># estilo visual (ej: 'seaborn-v0_8', 'default', 'classic')</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s2">"_______"</span><span class="p">)</span>  <span class="c1"># paleta de colores (ej: 'husl', 'Set1', 'viridis')</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">'figure.figsize'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">'font.size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"🎨 Configuración de visualizaciones lista!"</span><span class="p">)</span>
</code></pre></div>
<p><strong>💡 PISTAS:</strong></p>
<ul>
<li>🎨 <a href="https://matplotlib.org/stable/gallery/style_sheets/style_sheets_reference.html">Estilos de matplotlib</a></li>
<li>🌈 <a href="https://seaborn.pydata.org/tutorial/color_palettes.html">Paletas de seaborn</a></li>
<li>💭 ¿Qué estilo se ve más profesional para análisis de datos?</li>
</ul>
<h3 id="paso-2-cargar-y-crear-missing-data-sintetico">🏠 <strong>Paso 2: Cargar y Crear Missing Data Sintético</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-2-cargar-y-crear-missing-data-sintetico" title="Permanent link">¶</a></h3>
<div class="highlight"><pre id="__code_1"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_1 &gt; code"></button><code tabindex="0"><span class="c1"># === CARGAR DATASET AMES HOUSING ===</span>

<span class="c1"># 1. Cargar dataset base</span>
<span class="err">!</span><span class="n">curl</span> <span class="o">-</span><span class="n">L</span> <span class="o">-</span><span class="n">o</span> <span class="n">ames</span><span class="o">-</span><span class="n">housing</span><span class="o">-</span><span class="n">dataset</span><span class="o">.</span><span class="n">zip</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">kaggle</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">datasets</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">shashanknecrothapa</span><span class="o">/</span><span class="n">ames</span><span class="o">-</span><span class="n">housing</span><span class="o">-</span><span class="n">dataset</span>
<span class="err">!</span><span class="n">unzip</span> <span class="n">ames</span><span class="o">-</span><span class="n">housing</span><span class="o">-</span><span class="n">dataset</span><span class="o">.</span><span class="n">zip</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'AmesHousing.csv'</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">"🏠 DATASET: Ames Housing"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"   📊 Forma original: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"   📋 Columnas: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># 2. Crear missing data sintético para práctica</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># para reproducibilidad</span>

<span class="c1"># Simular MCAR en Year Built (8% missing aleatorio)</span>
<span class="c1"># "Los valores faltan al azar: que falte un Year Built no depende de la edad ni del propio Year Built"</span>
<span class="n">missing_year</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.08</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missing_year</span><span class="p">,</span> <span class="s1">'Year Built'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">_____</span>

<span class="c1"># Simular MAR en Garage Area (missing relacionado con Garage Type)</span>
<span class="c1"># "Los faltantes de Garage Area se concentran en ciertos tipos de garaje (variable observada)"</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'Garage Type'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'None'</span><span class="p">,</span> <span class="s1">'Garage Area'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'Garage Type'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'None'</span><span class="p">,</span> <span class="s1">'Garage Area'</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Simular MNAR en SalePrice (missing relacionado con precio alto)</span>
<span class="c1"># "Los faltantes dependen del propio valor: quienes tienen precios altos no reportan precio"</span>
<span class="n">high_price</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'SalePrice'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">df</span><span class="p">[</span><span class="s1">'SalePrice'</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.85</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">high_price</span><span class="p">,</span> <span class="s1">'SalePrice'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">high_price</span><span class="p">,</span> <span class="s1">'SalePrice'</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">🔍 Missing data sintético creado:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>  <span class="c1"># método para contar valores faltantes por columna</span>
</code></pre></div>
<p><strong>💡 PISTAS:</strong></p>
<ul>
<li>❓ ¿Qué valor se usa para representar datos faltantes en pandas? (np.nan, None, 'missing')</li>
<li>🔢 ¿Qué método cuenta valores faltantes? <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isnull.html">Documentación</a></li>
</ul>
<h3 id="paso-3-analisis-inicial-del-dataset">📊 <strong>Paso 3: Análisis Inicial del Dataset</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-3-analisis-inicial-del-dataset" title="Permanent link">¶</a></h3>
<div class="highlight"><pre id="__code_2"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_2 &gt; code"></button><code tabindex="0"><span class="c1"># === EXPLORACIÓN BÁSICA ===</span>

<span class="c1"># 1. Información general del dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"=== INFORMACIÓN GENERAL ==="</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">_____</span><span class="p">())</span>  <span class="c1"># método que muestra tipos de datos, memoria y valores no nulos</span>

<span class="c1"># 2. Estadísticas descriptivas</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">=== ESTADÍSTICAS DESCRIPTIVAS ==="</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">_____</span><span class="p">())</span>  <span class="c1"># método que calcula estadísticas descriptivas</span>

<span class="c1"># 3. Tipos de datos</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">=== TIPOS DE DATOS ==="</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">_____</span><span class="p">)</span>  <span class="c1"># atributo que muestra tipos de datos por columna</span>

<span class="c1"># 4. Verificar missing data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">=== MISSING DATA POR COLUMNA ==="</span><span class="p">)</span>
<span class="n">missing_count</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># contar valores faltantes</span>
<span class="n">missing_pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">missing_count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># calcular porcentaje</span>

<span class="n">missing_stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">'Column'</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
    <span class="s1">'Missing_Count'</span><span class="p">:</span> <span class="n">missing_count</span><span class="p">,</span>
    <span class="s1">'Missing_Percentage'</span><span class="p">:</span> <span class="n">missing_pct</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">missing_stats</span><span class="p">[</span><span class="n">missing_stats</span><span class="p">[</span><span class="s1">'Missing_Count'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1"># 5. Análisis de memoria</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">=== ANÁLISIS DE MEMORIA ==="</span><span class="p">)</span>
<span class="n">total_bytes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># método para memoria en bytes</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Memoria total del DataFrame: </span><span class="si">{</span><span class="n">total_bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MB"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Memoria por columna:"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">memory_usage</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span>  <span class="c1"># método para memoria de una columna</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">memory_usage</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> KB"</span><span class="p">)</span>

<span class="c1"># 6. Análisis de duplicados</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">=== ANÁLISIS DE DUPLICADOS ==="</span><span class="p">)</span>
<span class="n">duplicates</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span>  <span class="c1"># método para detectar filas duplicadas</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Número de filas duplicadas: </span><span class="si">{</span><span class="n">duplicates</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="k">if</span> <span class="n">duplicates</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Primeras 5 filas duplicadas:"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">_____</span><span class="p">()]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>  <span class="c1"># método para filtrar duplicados</span>
</code></pre></div>
<p><strong>💡 PISTAS:</strong></p>
<ul>
<li>ℹ️ ¿Qué método da información sobre tipos y memoria? <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.info.html">Documentación</a></li>
<li>📊 ¿Qué método calcula estadísticas descriptivas? <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.describe.html">Documentación</a></li>
<li>🔢 ¿Qué atributo muestra tipos de datos? <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.dtypes.html">Documentación</a></li>
<li>❓ ¿Qué método cuenta valores faltantes? <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isnull.html">Documentación</a></li>
<li>💾 ¿Qué método calcula uso de memoria? <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.memory_usage.html">Documentación</a></li>
<li>🔍 ¿Qué método detecta filas duplicadas? <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.duplicated.html">Documentación</a></li>
</ul>
<hr>
<h3 id="paso-4-deteccion-de-patrones-de-missing-data">🔍 <strong>Paso 4: Detección de Patrones de Missing Data</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-4-deteccion-de-patrones-de-missing-data" title="Permanent link">¶</a></h3>
<div class="highlight"><pre id="__code_3"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_3 &gt; code"></button><code tabindex="0"><span class="c1"># === ANÁLISIS DE PATRONES DE MISSING DATA ===</span>

<span class="c1"># 1. Filtrar solo columnas con missing data para visualización</span>
<span class="n">missing_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># método para detectar missing</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Columnas con missing data: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_columns</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Columnas: </span><span class="si">{</span><span class="n">missing_columns</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># 2. Visualización mejorada sin missingno</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="c1"># Crear estadísticas de missing solo para columnas con missing data</span>
    <span class="n">missing_count</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">missing_columns</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># método para contar missing</span>
    <span class="n">missing_pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">missing_count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># calcular porcentaje</span>

    <span class="n">missing_stats_filtered</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">'Column'</span><span class="p">:</span> <span class="n">missing_columns</span><span class="p">,</span>
        <span class="s1">'Missing_Count'</span><span class="p">:</span> <span class="n">missing_count</span><span class="p">,</span>
        <span class="s1">'Missing_Percentage'</span><span class="p">:</span> <span class="n">missing_pct</span>
    <span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Missing_Percentage'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Crear gráfico de barras más limpio</span>
    <span class="n">bars</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_stats_filtered</span><span class="p">)),</span> <span class="n">missing_stats_filtered</span><span class="p">[</span><span class="s1">'Missing_Percentage'</span><span class="p">],</span> 
                   <span class="n">color</span><span class="o">=</span><span class="s1">'steelblue'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># función para barras</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Top 10: Porcentaje de Missing por Columna'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_stats_filtered</span><span class="p">)),</span> <span class="n">missing_stats_filtered</span><span class="p">[</span><span class="s1">'Column'</span><span class="p">],</span> 
               <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'right'</span><span class="p">)</span>  <span class="c1"># función para etiquetas del eje X</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Porcentaje de Missing (%)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">'y'</span><span class="p">)</span>

    <span class="c1"># Agregar valores en las barras</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bars</span><span class="p">):</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span>
                <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">height</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%'</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'bottom'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">'No hay missing data'</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Porcentaje de Missing por Columna'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>

<span class="c1"># Distribución de missing por fila</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">missing_per_row</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># contar missing por fila</span>
<span class="n">plt</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">missing_per_row</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">missing_per_row</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
         <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'lightcoral'</span><span class="p">)</span>  <span class="c1"># función para histograma</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Distribución de Missing por Fila'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Número de valores faltantes por fila'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Frecuencia'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">'y'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="err">!</span><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="n">results</span><span class="o">/</span><span class="n">visualizaciones</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'results/visualizaciones/missing_patterns.png'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">'tight'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><strong>💡 PISTAS:</strong></p>
<ul>
<li>❓ ¿Qué método detecta valores faltantes? <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isnull.html">Documentación</a></li>
<li>📊 ¿Qué función de matplotlib crea barras? <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.bar.html">Documentación</a></li>
<li>🏷️ ¿Qué función establece etiquetas del eje X? <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xticks.html">Documentación</a></li>
<li>📈 ¿Qué función crea histogramas? <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.hist.html">Documentación</a></li>
<li>🔢 ¿Cómo contar missing por fila? (axis=1 para filas, axis=0 para columnas)</li>
</ul>
<h3 id="paso-5-clasificar-tipos-de-missing-data">🧠 <strong>Paso 5: Clasificar Tipos de Missing Data</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-5-clasificar-tipos-de-missing-data" title="Permanent link">¶</a></h3>
<div class="highlight"><pre id="__code_4"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_4 &gt; code"></button><code tabindex="0"><span class="c1"># === CLASIFICACIÓN MCAR/MAR/MNAR ===</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"=== ANÁLISIS DE TIPOS DE MISSING ==="</span><span class="p">)</span>

<span class="c1"># 1. Year Built: ¿MCAR o MAR?</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">1. YEAR BUILT - Análisis de patrones:"</span><span class="p">)</span>
<span class="n">year_missing</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Year Built'</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span>  <span class="c1"># método para detectar missing</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Missing Year Built por Neighborhood:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'Neighborhood'</span><span class="p">)[</span><span class="s1">'Year Built'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>  <span class="c1"># contar missing por grupo</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Missing Year Built por House Style:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'House Style'</span><span class="p">)[</span><span class="s1">'Year Built'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>

<span class="c1"># 2. Garage Area: ¿MAR?</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">2. GARAGE AREA - Análisis de patrones:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Missing Garage Area por Garage Type:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'Garage Type'</span><span class="p">)[</span><span class="s1">'Garage Area'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>

<span class="c1"># 3. SalePrice: ¿MNAR?</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">3. SALEPRICE - Análisis de patrones:"</span><span class="p">)</span>
<span class="n">price_missing</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'SalePrice'</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Valores de SalePrice en registros con missing:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">price_missing</span><span class="p">][</span><span class="s1">'SalePrice'</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">())</span>  <span class="c1"># estadísticas descriptivas</span>
</code></pre></div>
<p><strong>💡 PISTAS:</strong></p>
<ul>
<li>❓ ¿Qué método detecta valores faltantes? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.isnull.html">Documentación</a></li>
<li>📊 ¿Qué método calcula estadísticas descriptivas? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.describe.html">Documentación</a></li>
<li>🧠 <strong>MCAR</strong>: Missing Completely At Random (aleatorio)</li>
<li>🧠 <strong>MAR</strong>: Missing At Random (relacionado con variables observadas)</li>
<li>🧠 <strong>MNAR</strong>: Missing Not At Random (relacionado con el valor faltante mismo)</li>
</ul>
<hr>
<h3 id="paso-6-deteccion-de-outliers">🚨 <strong>Paso 6: Detección de Outliers</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-6-deteccion-de-outliers" title="Permanent link">¶</a></h3>
<div class="highlight"><pre id="__code_5"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_5 &gt; code"></button><code tabindex="0"><span class="c1"># === DETECCIÓN DE OUTLIERS CON IQR ===</span>
<span class="c1"># "Detectar extremos usando mediana y cuartiles"</span>
<span class="c1"># "Cuándo usar: distribuciones asimétricas / colas pesadas / presencia de outliers"</span>
<span class="k">if</span> <span class="s2">"Year Built"</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">"Year Built"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">"Year Built"</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">"coerce"</span><span class="p">)</span>

<span class="c1"># === DETECCIÓN DE OUTLIERS: IQR y Z-SCORE (robustas) ===</span>
<span class="k">def</span><span class="w"> </span><span class="nf">detect_outliers_iqr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">1.5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Outliers por IQR. Devuelve (df_outliers, lower, upper)."""</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">"coerce"</span><span class="p">)</span>
    <span class="n">x_no_na</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    <span class="k">if</span> <span class="n">x_no_na</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># sin datos válidos</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[]],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x_no_na</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
    <span class="n">q3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x_no_na</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
    <span class="n">iqr</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">-</span> <span class="n">q1</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">-</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">iqr</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">+</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">iqr</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">"coerce"</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">lower</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">"coerce"</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>

<span class="c1"># Analizar outliers en columnas numéricas</span>
<span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>  <span class="c1"># método para seleccionar columnas numéricas</span>
<span class="n">outlier_analysis</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>  <span class="c1"># método para verificar si hay missing data</span>
        <span class="n">outliers</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">detect_outliers_iqr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
        <span class="n">outlier_analysis</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">'count'</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">outliers</span><span class="p">),</span>
            <span class="s1">'percentage'</span><span class="p">:</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">outliers</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
            <span class="s1">'lower_bound'</span><span class="p">:</span> <span class="n">lower</span><span class="p">,</span>
            <span class="s1">'upper_bound'</span><span class="p">:</span> <span class="n">upper</span>
        <span class="p">}</span>

<span class="n">outlier_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">outlier_analysis</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"=== ANÁLISIS DE OUTLIERS (IQR) ==="</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Útil cuando la distribución está chueca o con colas largas"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outlier_df</span><span class="p">)</span>

<span class="c1"># Análisis adicional de outliers</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">=== RESUMEN DE OUTLIERS ==="</span><span class="p">)</span>
<span class="n">total_outliers</span> <span class="o">=</span> <span class="n">outlier_df</span><span class="p">[</span><span class="s1">'count'</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span>  <span class="c1"># método para sumar outliers</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total de outliers detectados: </span><span class="si">{</span><span class="n">total_outliers</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Porcentaje promedio de outliers: </span><span class="si">{</span><span class="n">outlier_df</span><span class="p">[</span><span class="s1">'percentage'</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%"</span><span class="p">)</span>  <span class="c1"># método para calcular media</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Columna con más outliers: </span><span class="si">{</span><span class="n">outlier_df</span><span class="p">[</span><span class="s1">'count'</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># método para encontrar máximo</span>
</code></pre></div>
<h3 id="paso-7-deteccion-de-outliers-con-z-score">🔍 <strong>Paso 7: Detección de Outliers con Z-Score</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-7-deteccion-de-outliers-con-z-score" title="Permanent link">¶</a></h3>
<div class="highlight"><pre id="__code_6"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_6 &gt; code"></button><code tabindex="0"><span class="c1"># === DETECCIÓN DE OUTLIERS CON Z-SCORE ===</span>
<span class="c1"># "Cuándo usar: distribución aprox. campana y sin colas raras"</span>
<span class="c1"># "Regla: 3 pasos (desvios) desde el promedio = raro"</span>

<span class="k">def</span><span class="w"> </span><span class="nf">detect_outliers_zscore</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Detectar outliers usando Z-Score - Regla: 3 desvios desde el promedio = raro"""</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
    <span class="n">z_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">zscore</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()))</span>
    <span class="n">outlier_indices</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">z_scores</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">outlier_indices</span><span class="p">]</span>

<span class="c1"># Comparar métodos de detección</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">=== COMPARACIÓN DE MÉTODOS DE DETECCIÓN ==="</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'SalePrice'</span><span class="p">,</span> <span class="s1">'Lot Area'</span><span class="p">,</span> <span class="s1">'Year Built'</span><span class="p">,</span> <span class="s1">'Garage Area'</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">iqr_outliers</span> <span class="o">=</span> <span class="n">detect_outliers_iqr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
        <span class="n">zscore_outliers</span> <span class="o">=</span> <span class="n">detect_outliers_zscore</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">:"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  IQR outliers: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">iqr_outliers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">iqr_outliers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Z-Score outliers: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">zscore_outliers</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">zscore_outliers</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)"</span><span class="p">)</span>
</code></pre></div>
<p><strong>💡 PISTAS:</strong></p>
<ul>
<li>📊 <strong>IQR</strong>: Interquartile Range = Q3 - Q1</li>
<li>🚨 <strong>Outliers</strong>: Valores fuera de [Q1-1.5<em>IQR, Q3+1.5</em>IQR]</li>
<li>🔢 ¿Qué método selecciona columnas numéricas? <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.select_dtypes.html">Documentación</a></li>
<li>❓ ¿Qué método verifica missing data? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.isnull.html">Documentación</a></li>
<li>➕ ¿Qué método suma valores? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.sum.html">Documentación</a></li>
<li>📊 ¿Qué método calcula la media? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.mean.html">Documentación</a></li>
<li>🔝 ¿Qué método encuentra el máximo? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.idxmax.html">Documentación</a></li>
</ul>
<h3 id="paso-8-visualizacion-de-outliers">📊 <strong>Paso 8: Visualización de Outliers</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-8-visualizacion-de-outliers" title="Permanent link">¶</a></h3>
<div class="highlight"><pre id="__code_7"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_7 &gt; code"></button><code tabindex="0"><span class="c1"># === VISUALIZAR OUTLIERS ===</span>
<span class="n">os</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="s1">'results/visualizaciones'</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'SalePrice'</span><span class="p">,</span> <span class="s1">'Lot Area'</span><span class="p">,</span> <span class="s1">'Year Built'</span><span class="p">,</span> <span class="s1">'Garage Area'</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>  <span class="c1"># función para crear subplots</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span>  <span class="c1"># método para aplanar array</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">continue</span>

    <span class="c1"># convertir a numérico de forma segura</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">: sin datos numéricos"</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
        <span class="k">continue</span>

    <span class="c1"># Boxplot usando el vector numérico (evita inferencias de dtype de seaborn)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="c1"># función para boxplot</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Outliers en </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">'</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

    <span class="c1"># Outliers por IQR y bandas</span>
    <span class="n">iqr_df</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">detect_outliers_iqr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
    <span class="n">out_vals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">iqr_df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">lower</span><span class="p">):</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Límite IQR'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">upper</span><span class="p">):</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">upper</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Marcar outliers con un leve jitter en X para que se vean</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_vals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">jitter_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">out_vals</span><span class="p">))</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">jitter_x</span><span class="p">,</span> <span class="n">out_vals</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">'Outliers (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">out_vals</span><span class="p">)</span><span class="si">}</span><span class="s1">)'</span><span class="p">)</span> <span class="c1"># función para scatter</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span>  <span class="c1"># método para mostrar leyenda</span>

    <span class="c1"># Opcional: si la variable es muy sesgada, usar escala log</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'Lot Area'</span><span class="p">,</span> <span class="s1">'SalePrice'</span><span class="p">]</span> <span class="ow">and</span> <span class="n">y</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Outliers en </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1"> (escala log)'</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span> <span class="c1"># función para ajustar layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="s1">'results/visualizaciones/outliers_analysis.png'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">'tight'</span><span class="p">)</span> <span class="c1"># función para guardar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span> <span class="c1"># función para mostrar gráfico</span>
</code></pre></div>
<p><strong>💡 PISTAS:</strong></p>
<ul>
<li>📁 ¿Cómo crear directorios? <a href="https://docs.python.org/3/library/os.html">Documentación</a></li>
<li>📊 ¿Qué función crea subplots? <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html">Documentación</a></li>
<li>🔄 ¿Qué método aplana arrays? <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.ravel.html">Documentación</a></li>
<li>📦 ¿Qué función crea boxplots? <a href="https://seaborn.pydata.org/generated/seaborn.boxplot.html">Documentación</a></li>
<li>🎯 ¿Qué función crea scatter plots? <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.scatter.html">Documentación</a></li>
<li>🏷️ ¿Qué método muestra leyendas? <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html">Documentación</a></li>
<li>📐 ¿Qué función ajusta layout? <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.tight_layout.html">Documentación</a></li>
<li>💾 ¿Qué función guarda gráficos? <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.savefig.html">Documentación</a></li>
<li>👁️ ¿Qué función muestra gráficos? <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html">Documentación</a></li>
<li>🔴 Los puntos rojos son outliers detectados</li>
</ul>
<hr>
<h3 id="paso-9-estrategias-de-imputacion">🔧 <strong>Paso 9: Estrategias de Imputación</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-9-estrategias-de-imputacion" title="Permanent link">¶</a></h3>
<div class="highlight"><pre id="__code_8"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_8 &gt; code"></button><code tabindex="0"><span class="c1"># === IMPLEMENTAR ESTRATEGIAS DE IMPUTACIÓN ===</span>
<span class="c1"># "Rellenar no es gratis; hacelo columna a columna y documentá"</span>
<span class="c1"># "Num: mediana (si cola pesada) / media (si ~normal)"</span>
<span class="c1"># "Cat: moda o 'Unknown' (+ flag si sospecha MNAR)"</span>

<span class="k">def</span><span class="w"> </span><span class="nf">impute_missing_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s1">'median'</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Implementar diferentes estrategias de imputación - Reglas simples de la clase"""</span>
    <span class="n">df_imputed</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'int64'</span><span class="p">,</span> <span class="s1">'float64'</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">'mean'</span><span class="p">:</span>
                    <span class="n">df_imputed</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">(),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># imputar con media</span>
                <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">'median'</span><span class="p">:</span>
                    <span class="n">df_imputed</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">(),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># imputar con mediana</span>
                <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">'mode'</span><span class="p">:</span>
                    <span class="n">df_imputed</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># imputar con moda</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Para variables categóricas</span>
                <span class="n">df_imputed</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># imputar con moda</span>

    <span class="k">return</span> <span class="n">df_imputed</span>

<span class="c1"># Probar diferentes estrategias</span>
<span class="n">strategies</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'mean'</span><span class="p">,</span> <span class="s1">'median'</span><span class="p">,</span> <span class="s1">'mode'</span><span class="p">]</span>
<span class="n">imputed_datasets</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
    <span class="n">imputed_datasets</span><span class="p">[</span><span class="n">strategy</span><span class="p">]</span> <span class="o">=</span> <span class="n">impute_missing_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Estrategia </span><span class="si">{</span><span class="n">strategy</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">imputed_datasets</span><span class="p">[</span><span class="n">strategy</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2"> missing values restantes"</span><span class="p">)</span>
</code></pre></div>
<p><strong>💡 PISTAS:</strong></p>
<ul>
<li>📊 ¿Qué método calcula la media? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.mean.html">Documentación</a></li>
<li>📊 ¿Qué método calcula la mediana? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.median.html">Documentación</a></li>
<li>📊 ¿Qué método calcula la moda? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.mode.html">Documentación</a></li>
<li>🔧 ¿Qué método imputa valores faltantes? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.fillna.html">Documentación</a></li>
</ul>
<h3 id="paso-10-imputacion-inteligente-por-tipo-de-missing">🧠 <strong>Paso 10: Imputación Inteligente por Tipo de Missing</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-10-imputacion-inteligente-por-tipo-de-missing" title="Permanent link">¶</a></h3>
<div class="highlight"><pre id="__code_9"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_9 &gt; code"></button><code tabindex="0"><span class="k">def</span><span class="w"> </span><span class="nf">smart_imputation</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">impute_saleprice</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Imputación inteligente robusta a dtypes y NaN."""</span>
    <span class="n">df_imputed</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># --- 0) Asegurar dtypes numéricos donde corresponde ---</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"Year Built"</span><span class="p">,</span> <span class="s2">"Garage Area"</span><span class="p">,</span> <span class="s2">"SalePrice"</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df_imputed</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">df_imputed</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">df_imputed</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">"coerce"</span><span class="p">)</span>  <span class="c1"># to_numeric</span>

    <span class="c1"># --- 1) Year Built: mediana por (Neighborhood, House Style) -&gt; Neighborhood -&gt; global ---</span>
    <span class="k">if</span> <span class="p">{</span><span class="s2">"Neighborhood"</span><span class="p">,</span> <span class="s2">"House Style"</span><span class="p">,</span> <span class="s2">"Year Built"</span><span class="p">}</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">df_imputed</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
        <span class="n">grp_med</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="o">.</span><span class="n">_____</span><span class="p">([</span><span class="s2">"Neighborhood"</span><span class="p">,</span> <span class="s2">"House Style"</span><span class="p">])[</span><span class="s2">"Year Built"</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="s2">"median"</span><span class="p">)</span>  <span class="c1"># groupby, transform</span>
        <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Year Built"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Year Built"</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">grp_med</span><span class="p">)</span>  <span class="c1"># fillna</span>

        <span class="n">nb_med</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"Neighborhood"</span><span class="p">)[</span><span class="s2">"Year Built"</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s2">"median"</span><span class="p">)</span>
        <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Year Built"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Year Built"</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">nb_med</span><span class="p">)</span>

        <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Year Built"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Year Built"</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Year Built"</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span> <span class="p">))</span>  <span class="c1"># median</span>
        <span class="c1"># Año entero nullable</span>
        <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Year Built"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Year Built"</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span> <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"Int64"</span><span class="p">)</span>  <span class="c1"># round</span>

    <span class="c1"># --- 2) Garage Area: MNAR → indicador + 0; resto por mediana del barrio ---</span>
    <span class="k">if</span> <span class="s2">"Garage Area"</span> <span class="ow">in</span> <span class="n">df_imputed</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"GarageArea_was_na"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Garage Area"</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span> <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"Int8"</span><span class="p">)</span>  <span class="c1"># isna</span>

        <span class="c1"># Si hay "Garage Cars", usarlo para inferir "sin garaje" (0 área)</span>
        <span class="k">if</span> <span class="s2">"Garage Cars"</span> <span class="ow">in</span> <span class="n">df_imputed</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">no_garage_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Garage Cars"</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Garage Area"</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
            <span class="n">df_imputed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">no_garage_mask</span><span class="p">,</span> <span class="s2">"Garage Area"</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># Para los NaN restantes: mediana por Neighborhood, luego global</span>
        <span class="k">if</span> <span class="s2">"Neighborhood"</span> <span class="ow">in</span> <span class="n">df_imputed</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">med_gar</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"Neighborhood"</span><span class="p">)[</span><span class="s2">"Garage Area"</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s2">"median"</span><span class="p">)</span>
            <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Garage Area"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Garage Area"</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">med_gar</span><span class="p">)</span>

        <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Garage Area"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Garage Area"</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Garage Area"</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>

    <span class="c1"># --- 3) SalePrice: mediana por Neighborhood (opcional) ---</span>
    <span class="k">if</span> <span class="n">impute_saleprice</span> <span class="ow">and</span> <span class="p">{</span><span class="s2">"Neighborhood"</span><span class="p">,</span> <span class="s2">"SalePrice"</span><span class="p">}</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">df_imputed</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
        <span class="n">nb_price</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"Neighborhood"</span><span class="p">)[</span><span class="s2">"SalePrice"</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s2">"median"</span><span class="p">)</span>
        <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"SalePrice"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"SalePrice"</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">nb_price</span><span class="p">)</span>  <span class="c1"># fillna</span>
        <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"SalePrice"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"SalePrice"</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df_imputed</span><span class="p">[</span><span class="s2">"SalePrice"</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>

    <span class="c1"># --- 4) Garage Type: moda global (MCAR); manejar categorías ---</span>
    <span class="k">if</span> <span class="s2">"Garage Type"</span> <span class="ow">in</span> <span class="n">df_imputed</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="c1"># evitar problemas si es category</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Garage Type"</span><span class="p">]):</span>  <span class="c1"># is_categorical_dtype</span>
            <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Garage Type"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Garage Type"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"object"</span><span class="p">)</span>
        <span class="n">mode_val</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Garage Type"</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span> <span class="p">)</span>  <span class="c1"># mode</span>
        <span class="n">fill_val</span> <span class="o">=</span> <span class="n">mode_val</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">mode_val</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="s2">"Unknown"</span>
        <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Garage Type"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s2">"Garage Type"</span><span class="p">]</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">fill_val</span><span class="p">)</span>  <span class="c1"># fillna</span>

    <span class="k">return</span> <span class="n">df_imputed</span>

<span class="c1"># Aplicar</span>
<span class="n">df_smart_imputed</span> <span class="o">=</span> <span class="n">smart_imputation</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"=== IMPUTACIÓN INTELIGENTE ==="</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Missing restantes: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">df_smart_imputed</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<p><strong>💡 PISTAS:</strong></p>
<ul>
<li>🔢 ¿Qué función convierte una columna a numérico manejando errores? <a href="https://pandas.pydata.org/docs/reference/api/pandas.to_numeric.html">Documentación</a></li>
<li>🧩 ¿Cómo agrupás por columnas para calcular estadísticas por grupo? <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html">Documentación</a></li>
<li>🔄 ¿Cómo propagás el resultado de una agregación (p. ej., mediana) a cada fila del grupo? <a href="https://pandas.pydata.org/docs/reference/api/pandas.core.groupby.GroupBy.transform.html">Documentación</a></li>
<li>🧪 ¿Qué método usás para rellenar valores faltantes con un valor o serie? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.fillna.html">Documentación</a></li>
<li>📊 ¿Qué método calcula la mediana de una serie? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.median.html">Documentación</a></li>
<li>🧮 ¿Cómo redondeás valores en una serie antes de castear a entero anulable? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.round.html">Documentación</a></li>
<li>❓ ¿Qué método detecta valores faltantes en una serie? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.isna.html">Documentación</a></li>
<li>📈 ¿Qué método obtiene la moda de una serie? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.mode.html">Documentación</a></li>
<li>🏷️ ¿Cómo verificás si una serie es de tipo categórico? <a href="https://pandas.pydata.org/docs/reference/api/pandas.api.types.is_categorical_dtype.html">Documentación</a></li>
</ul>
<hr>
<h3 id="paso-11-anti-leakage-basico">🚫 <strong>Paso 11: Anti-Leakage Básico</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-11-anti-leakage-basico" title="Permanent link">¶</a></h3>
<div class="highlight"><pre id="__code_10"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_10 &gt; code"></button><code tabindex="0"><span class="c1"># === ANTI-LEAKAGE BÁSICO ===</span>
<span class="c1"># "No espiés el examen: fit en TRAIN, transform en VALID/TEST"</span>
<span class="c1"># "Split: X_train / X_valid / X_test"</span>
<span class="c1"># "imputer.fit(X_train) → transform al resto"</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># 1. Split de datos (ANTES de imputar)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'SalePrice'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># features</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'SalePrice'</span><span class="p">]</span>  <span class="c1"># target</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_temp</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_temp</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_valid</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_temp</span><span class="p">,</span> <span class="n">y_temp</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"=== SPLIT DE DATOS ==="</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Train: </span><span class="si">{</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> registros"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Valid: </span><span class="si">{</span><span class="n">X_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> registros"</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Test: </span><span class="si">{</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> registros"</span><span class="p">)</span>

<span class="c1"># 2. Imputar SOLO en train, luego transformar</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleImputer</span>

<span class="c1"># Separar columnas numéricas y categóricas</span>
<span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">categorical_columns</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">'object'</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Columnas numéricas: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">numeric_columns</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Columnas categóricas: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Crear imputers para cada tipo de dato</span>
<span class="n">numeric_imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">'_____'</span><span class="p">)</span>  <span class="c1"># estrategia para numéricas</span>
<span class="n">categorical_imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">'_____'</span><span class="p">)</span>  <span class="c1"># estrategia para categóricas</span>

<span class="c1"># Ajustar imputers SOLO con train</span>
<span class="n">numeric_imputer</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">numeric_columns</span><span class="p">])</span>  <span class="c1"># ajustar numéricas</span>
<span class="n">categorical_imputer</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">])</span>  <span class="c1"># ajustar categóricas</span>

<span class="c1"># Transformar todos los conjuntos</span>
<span class="n">X_train_numeric</span> <span class="o">=</span> <span class="n">numeric_imputer</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">numeric_columns</span><span class="p">])</span>  <span class="c1"># transformar numéricas</span>
<span class="n">X_train_categorical</span> <span class="o">=</span> <span class="n">categorical_imputer</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">])</span>  <span class="c1"># transformar categóricas</span>

<span class="n">X_valid_numeric</span> <span class="o">=</span> <span class="n">numeric_imputer</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">X_valid</span><span class="p">[</span><span class="n">numeric_columns</span><span class="p">])</span>
<span class="n">X_valid_categorical</span> <span class="o">=</span> <span class="n">categorical_imputer</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">X_valid</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">])</span>

<span class="n">X_test_numeric</span> <span class="o">=</span> <span class="n">numeric_imputer</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">numeric_columns</span><span class="p">])</span>
<span class="n">X_test_categorical</span> <span class="o">=</span> <span class="n">categorical_imputer</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">✅ Anti-leakage aplicado: fit solo en train, transform en todo"</span><span class="p">)</span>
</code></pre></div>
<p><strong>💡 PISTAS:</strong></p>
<ul>
<li>🔢 ¿Qué estrategia usar para numéricas? ('median', 'mean', 'most_frequent')</li>
<li>📝 ¿Qué estrategia usar para categóricas? ('most_frequent', 'constant')</li>
<li>🎯 ¿Qué método ajusta el imputer? <a href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html">Documentación</a></li>
<li>🔄 ¿Qué método aplica las transformaciones? <a href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html">Documentación</a></li>
<li>📊 ¿Qué método separa tipos de datos? <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.select_dtypes.html">Documentación</a></li>
</ul>
<hr>
<h3 id="paso-12-analisis-de-impacto-de-la-imputacion">📊 <strong>Paso 12: Análisis de Impacto de la Imputación</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-12-analisis-de-impacto-de-la-imputacion" title="Permanent link">¶</a></h3>
<div class="highlight"><pre id="__code_11"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_11 &gt; code"></button><code tabindex="0"><span class="c1"># 1) Crear df_imputed con imputación simple, robusta a dtypes</span>
<span class="n">df_imputed</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
    <span class="c1"># Si es numérica o puede convertirse a numérica, imputar mediana</span>
    <span class="k">if</span> <span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">"object"</span><span class="p">):</span>
        <span class="n">s_num</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">"coerce"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s_num</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">df_imputed</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">s_num</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">s_num</span><span class="o">.</span><span class="n">_____</span><span class="p">())</span> <span class="c1"># imputar numéricas con mediana</span>
            <span class="k">continue</span>
    <span class="c1"># Caso categórico: imputar con moda (si existe), sino "Unknown"</span>
    <span class="n">moda</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">_____</span><span class="p">()</span> <span class="c1"># imputar categóricas con moda</span>
    <span class="n">fill_val</span> <span class="o">=</span> <span class="n">moda</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">moda</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="s2">"Unknown"</span>
    <span class="n">df_imputed</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">fill_val</span><span class="p">)</span>

<span class="c1"># 2) Comparar distribuciones (hist para numéricas, barras para categóricas)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">cols_to_plot</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'SalePrice'</span><span class="p">,</span> <span class="s1">'Lot Area'</span><span class="p">,</span> <span class="s1">'Year Built'</span><span class="p">,</span> <span class="s1">'Garage Area'</span><span class="p">,</span> <span class="s1">'Neighborhood'</span><span class="p">,</span> <span class="s1">'House Style'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cols_to_plot</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1"> no existe'</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>
        <span class="k">continue</span>

    <span class="n">s_orig</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
    <span class="n">s_imp</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

    <span class="c1"># Intentar tratar como numérico (coerce) para decidir el tipo de gráfico</span>
    <span class="n">s_orig_num</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">s_orig</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>
    <span class="n">s_imp_num</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">s_imp</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">s_orig_num</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="ow">and</span> <span class="n">s_imp_num</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="c1"># NUMÉRICAS → hist</span>
        <span class="c1"># Mismo rango/bins para una comparación justa</span>
        <span class="n">data_combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s_orig_num</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">s_imp_num</span><span class="o">.</span><span class="n">dropna</span><span class="p">()])</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram_bin_edges</span><span class="p">(</span><span class="n">data_combined</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">s_orig_num</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Original'</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="s1">'steelblue'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">s_imp_num</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Imputado'</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="s1">'orange'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>

        <span class="c1"># Si está muy sesgada, te puede servir escala log</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'Lot Area'</span><span class="p">,</span> <span class="s1">'SalePrice'</span><span class="p">]</span> <span class="ow">and</span> <span class="n">s_orig_num</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># CATEGÓRICAS → barras (top-K categorías para legibilidad)</span>
        <span class="n">K</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="n">vc_orig</span> <span class="o">=</span> <span class="n">s_orig</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'object'</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">'Missing'</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
        <span class="n">vc_imp</span>  <span class="o">=</span> <span class="n">s_imp</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'object'</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">'Missing'</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
        <span class="n">cats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">vc_orig</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">vc_imp</span><span class="o">.</span><span class="n">index</span><span class="p">)))[:</span><span class="n">K</span><span class="p">]</span>  <span class="c1"># unión ordenada</span>

        <span class="n">vc_orig</span> <span class="o">=</span> <span class="n">vc_orig</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">cats</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">vc_imp</span>  <span class="o">=</span> <span class="n">vc_imp</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">cats</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cats</span><span class="p">))</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mf">0.4</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">vc_orig</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Original'</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">vc_imp</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>  <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Imputado'</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">cats</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'right'</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Distribución de </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">'</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'results/visualizaciones/distribution_comparison.png'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">'tight'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 3) Correlaciones (solo numéricas y con coerción segura)</span>
<span class="n">important_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'SalePrice'</span><span class="p">,</span> <span class="s1">'Lot Area'</span><span class="p">,</span> <span class="s1">'Year Built'</span><span class="p">,</span> <span class="s1">'Garage Area'</span><span class="p">,</span> <span class="s1">'Overall Qual'</span><span class="p">,</span> <span class="s1">'Gr Liv Area'</span><span class="p">,</span> <span class="s1">'Total Bsmt SF'</span><span class="p">]</span>
<span class="n">available_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">important_cols</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Columnas seleccionadas para correlaciones: </span><span class="si">{</span><span class="n">available_cols</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">df_num_original</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">available_cols</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>
<span class="n">df_num_imputed</span>  <span class="o">=</span> <span class="n">df_imputed</span><span class="p">[</span><span class="n">available_cols</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">corr_original</span> <span class="o">=</span> <span class="n">df_num_original</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># método para matriz de correlación</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_original</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'coolwarm'</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">'.2f'</span><span class="p">,</span> <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">'shrink'</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">})</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Correlaciones - Original'</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">corr_imputed</span> <span class="o">=</span> <span class="n">df_num_imputed</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># método para matriz de correlación</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_imputed</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'coolwarm'</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">'.2f'</span><span class="p">,</span> <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">'shrink'</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">})</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Correlaciones - Imputado'</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'results/visualizaciones/correlation_comparison.png'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">'tight'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 4) Diferencias en correlaciones</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">=== DIFERENCIAS EN CORRELACIONES ==="</span><span class="p">)</span>
<span class="n">corr_diff</span> <span class="o">=</span> <span class="n">corr_imputed</span> <span class="o">-</span> <span class="n">corr_original</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Cambios en correlaciones (Imputado - Original):"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</code></pre></div>
<p><strong>💡 PISTAS:</strong></p>
<ul>
<li>📊 ¿Qué método calcula la mediana? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.median.html">Documentación</a></li>
<li>📊 ¿Qué método calcula la moda? <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.mode.html">Documentación</a></li>
<li>📊 ¿Qué método calcula matriz de correlación? <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.corr.html">Documentación</a></li>
<li>📈 ¿Qué función de seaborn crea heatmaps? <a href="https://seaborn.pydata.org/generated/seaborn.heatmap.html">Documentación</a></li>
</ul>
<hr>
<h3 id="paso-13-pipeline-de-limpieza-reproducible">🔧 <strong>Paso 13: Pipeline de Limpieza Reproducible</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#paso-13-pipeline-de-limpieza-reproducible" title="Permanent link">¶</a></h3>
<div class="highlight"><pre id="__code_12"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_12 &gt; code"></button><code tabindex="0"><span class="c1"># === CREAR PIPELINE CON SKLEARN ===</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">OneHotEncoder</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_cleaning_pipeline</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""Crear pipeline de limpieza reproducible"""</span>

    <span class="c1"># Definir columnas numéricas y categóricas</span>
    <span class="n">numeric_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'SalePrice'</span><span class="p">,</span> <span class="s1">'Lot Area'</span><span class="p">,</span> <span class="s1">'Year Built'</span><span class="p">,</span> <span class="s1">'Garage Area'</span><span class="p">]</span>
    <span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Neighborhood'</span><span class="p">,</span> <span class="s1">'House Style'</span><span class="p">,</span> <span class="s1">'Garage Type'</span><span class="p">]</span>

    <span class="c1"># Transformadores</span>
    <span class="n">numeric_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">'imputer'</span><span class="p">,</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">'_____'</span><span class="p">)),</span>  <span class="c1"># estrategia de imputación</span>
        <span class="p">(</span><span class="s1">'scaler'</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">())</span>
    <span class="p">])</span>

    <span class="n">categorical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">'imputer'</span><span class="p">,</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">'_____'</span><span class="p">)),</span>  <span class="c1"># estrategia de imputación</span>
        <span class="p">(</span><span class="s1">'onehot'</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">))</span>
    <span class="p">])</span>

    <span class="c1"># Combinar transformadores</span>
    <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
        <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
            <span class="p">(</span><span class="s1">'num'</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">'cat'</span><span class="p">,</span> <span class="n">categorical_transformer</span><span class="p">,</span> <span class="n">categorical_features</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">preprocessor</span>

<span class="c1"># Crear y probar pipeline</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">create_cleaning_pipeline</span><span class="p">()</span>

<span class="c1"># Aplicar pipeline</span>
<span class="n">X_cleaned</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">_____</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>  <span class="c1"># método para aplicar transformaciones</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Shape después del pipeline: </span><span class="si">{</span><span class="n">X_cleaned</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Tipo de datos: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">X_cleaned</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<p><strong>💡 PISTAS:</strong></p>
<ul>
<li>🔧 ¿Qué estrategia usar para numéricas? ('median', 'mean', 'most_frequent')</li>
<li>🔧 ¿Qué estrategia usar para categóricas? ('most_frequent', 'constant')</li>
<li>🔧 ¿Qué método aplica las transformaciones? <a href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html">Documentación</a></li>
</ul>
<hr>
<h2 id="parte-b-analisis-critico">🎯 <strong>Parte B: Análisis Crítico</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#parte-b-analisis-critico" title="Permanent link">¶</a></h2>
<h3 id="preguntas-de-reflexion">📝 <strong>Preguntas de Reflexión</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#preguntas-de-reflexion" title="Permanent link">¶</a></h3>
<p>Responde estas preguntas en tu notebook:</p>
<ol>
<li>
<p><strong>¿Qué tipo de missing data identificaste en cada columna?</strong> Justifica tu clasificación.</p>
</li>
<li>
<p><strong>¿Por qué elegiste esas estrategias de imputación específicas?</strong> ¿Qué alternativas consideraste?</p>
</li>
<li>
<p><strong>¿Cómo podrían las decisiones de imputación afectar a diferentes grupos demográficos?</strong> (ej: barrios, tipos de vivienda)</p>
</li>
<li>
<p><strong>¿Qué información adicional necesitarías para tomar mejores decisiones sobre los outliers?</strong></p>
</li>
<li>
<p><strong>¿Cómo garantizas que tu pipeline sea reproducible y transparente?</strong></p>
</li>
</ol>
<hr>
<h2 id="sugerencias-para-explorar-mas">🚀 <strong>Sugerencias para Explorar Más</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#sugerencias-para-explorar-mas" title="Permanent link">¶</a></h2>
<h3 id="otros-datasets-interesantes">📊 <strong>Otros Datasets Interesantes</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#otros-datasets-interesantes" title="Permanent link">¶</a></h3>
<p><strong>🏥 Datasets de Salud:</strong>
- <a href="https://www.kaggle.com/datasets/johnsmith88/heart-disease-dataset">Heart Disease Dataset</a> - Missing data en variables médicas
- <a href="https://www.kaggle.com/datasets/sudalairajkumar/novel-corona-virus-2019-dataset">COVID-19 Dataset</a> - Datos temporales con missing values
- <a href="https://www.kaggle.com/datasets/mirichoi0218/insurance">Medical Cost Dataset</a> - Missing data en costos médicos</p>
<p><strong>💰 Datasets Financieros:</strong>
- <a href="https://www.kaggle.com/datasets/mlg-ulb/creditcardfraud">Credit Card Fraud Detection</a> - Missing data en transacciones
- <a href="https://www.kaggle.com/datasets/ninzaami/loan-predication">Loan Prediction Dataset</a> - Missing data en información crediticia
- <a href="https://www.kaggle.com/datasets/borismarjanovic/price-volume-data-for-all-us-stocks">Stock Market Data</a> - Missing data en precios históricos</p>
<p><strong>🌍 Datasets Ambientales:</strong>
- <a href="https://www.kaggle.com/datasets/rohanrao/air-quality-data-in-india">Air Quality Dataset</a> - Missing data en mediciones ambientales
- <a href="https://www.kaggle.com/datasets/berkeleyearth/climate-change-earth-surface-temperature-data">Weather Dataset</a> - Missing data en temperaturas históricas</p>
<h3 id="algoritmos-avanzados-de-imputacion">🔧 <strong>Algoritmos Avanzados de Imputación</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#algoritmos-avanzados-de-imputacion" title="Permanent link">¶</a></h3>
<p><strong>📈 Imputación Estadística Avanzada:</strong>
</p><div class="highlight"><pre id="__code_13"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_13 &gt; code"></button><code><span class="c1"># KNN Imputation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNNImputer</span>
<span class="n">knn_imputer</span> <span class="o">=</span> <span class="n">KNNImputer</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Iterative Imputation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.experimental</span><span class="w"> </span><span class="kn">import</span> <span class="n">enable_iterative_imputer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">IterativeImputer</span>
<span class="n">iterative_imputer</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Matrix Factorization</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">TruncatedSVD</span>
<span class="c1"># Para datos categóricos con missing</span>
</code></pre></div><p></p>
<h3 id="tecnicas-de-deteccion-de-outliers-avanzadas">🎯 <strong>Técnicas de Detección de Outliers Avanzadas</strong><a class="headerlink" href="https://juanfkurucz.com/ucu-id/ut2/05-missing-data-detective/#tecnicas-de-deteccion-de-outliers-avanzadas" title="Permanent link">¶</a></h3>
<p><strong>🔍 Métodos Estadísticos:</strong>
</p><div class="highlight"><pre id="__code_14"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_14 &gt; code"></button><code><span class="c1"># Isolation Forest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">IsolationForest</span>
<span class="n">isolation_forest</span> <span class="o">=</span> <span class="n">IsolationForest</span><span class="p">(</span><span class="n">contamination</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Local Outlier Factor (LOF)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalOutlierFactor</span>
<span class="n">lof</span> <span class="o">=</span> <span class="n">LocalOutlierFactor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># One-Class SVM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">OneClassSVM</span>
<span class="n">one_class_svm</span> <span class="o">=</span> <span class="n">OneClassSVM</span><span class="p">(</span><span class="n">nu</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</code></pre></div><p></p>
<p><strong>📊 Métodos de Visualización:</strong>
</p><div class="highlight"><pre id="__code_15"><span></span><button class="md-clipboard md-icon" title="Copiar al portapapeles" data-clipboard-target="#__code_15 &gt; code"></button><code><span class="c1"># DBSCAN Clustering</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.cluster</span><span class="w"> </span><span class="kn">import</span> <span class="n">DBSCAN</span>
<span class="n">dbscan</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># PCA para detección de outliers</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div><p></p>
<hr>
<p><em>"Los datos faltantes no son un problema técnico, son una oportunidad para entender mejor el mundo que representan."</em></p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Última actualización">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="10 de septiembre de 2025 13:33:43 UTC">10 de septiembre de 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.indexes", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="https://juanfkurucz.com/ucu-id/assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>